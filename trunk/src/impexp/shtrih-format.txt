Загрузка товаров

  	No        Тип               Назначение                       Назначение
	поля                          для товара                      для группы
[X]	0     Число 13       Код                             Код
[ ]	1     Строка 13      Штрих-код                       Не используется
[X]	2     Строка 100     Наименование для кассы          Наименование
[ ]	3     Строка 100     Текст для чека                  Не используется
[X]	4     Число 15.2     Цена                            Не используется
[ ]	5     Число 17.3     Остаток товара                  Не используется
[ ]	6     Число 5.0      Схема автоматической            Не используется
	                     скидки
[ ]	7     Число 1.0      Контроль продажи                Не используется
	                     дробного количества
[ ]	8     Число 2.0      Номер секции                    Не используется
[ ]	9     Число 5.1      Макс. процент скидки            Не используется
[ ]	10    Число 2.0      Код группы налогов              Не используется
[ ]	11    Строка 12      Артикул                         Не используется
[ ]	12    -              Не используется                 Не используется
[ ]	13    -              Не используется                 Не используется
[ ] 	14    -              Не используется                 Не используется
[X]	15    Строка 13      Код родительской группы         Код родительской группы
[X]	16    Число 1.0      Товар или группа: для           Товар или группа: для
	                     товара “1”                      группы “0”
     Поля No16 и No17 предназначены для построения иерархического списка товаров, т.е.
разбиения товаров по соответствующим группам при отображении в визуальном поиске.
Если используется линейная структура отображения, то поле No16=0 и No17=1.
     Для загрузки единиц измерения товаров (упаковки, пачки и т.п.), имеющих свой
штрих-код, строка начинается со знака «#», а формат строки следующий:
  No          Тип                    Назначение
 поля
1       Число 13       Код товара
2       Число 13       Штрих-код
3       Строка 100 Наименование
4       Строка 100 Наименование для кассы
5       Число 15.2 Цена
6                      Не используется
7                      Не используется
8                      Не используется
9                      Не используется
10      Число 17.3 Коэффициент
Остальные поля не используются

     Для загрузки дополнительных цен строка начинается со знака «?», а формат строки
следующий:
   No         Тип                    Назначение
 поля
1        Число 13       Код
2        Число 5.0      Код доп. цены
3        Строка 25      Наименование
4        Число 15.2     Цена
       Для загрузки схем автоматических скидок/надбавок строка начинается со знака «!»,
а формат строки следующий:
  No        Тип                 Назначение
поля
1      Число 5       Код схемы
2      Строка 30 Название схемы
3      Число 1.0     Применяется по карте
Остальные поля не используются
     Для загрузки автоматических скидок/надбавок каждой из схем строка начинается со
знака «@», а формат строки следующий:
  No        Тип                      Назначение
поля
1      Число 5.0     Код схемы скидок
2      Число 5.0     Код
3      Строка 30     Наименование
4      Число 1.0     Тип скидки (1-скидка, 2- надбавка)
5      Число 1.0     Вид скидки (1- процентная, 2-суммовая)
6      Число 15.2    Размер скидки
7      Строка 30     Текст для чека
8      Дата          Начальная дата
9      Дата          Конечная дата
10     Строка 5      Начальное время
11     Строка 5      Конечное время
12     Число 1.0     Номер начального дня недели
13     Число 1.0     Номер конечного дня недели
14     Число 17.3    Начальное количество
15     Число 17.3    Конечное количество
16     Число 17.2    Начальная сумма
17     Число 17.2    Конечная сумма
18     Число 5.0     Код дополнительной цены
19     Число 1.0     Флаг суммы чека
20     Число 2.0     Код группы карт
21     Число 1.0     Флаг «дня рождения»

     Для загрузки дисконтных карт строка начинается со знака «%», а формат строки
следующий:
  No        Тип                      Назначение
поля
1      Строка 24     Номер карты
2      Строка 100    Название карты
3      Строка 30     Текст для чека
4      Число 17.2    Сумма накопления
5      Число 5.0     Код схемы автоматических скидок
                     скидок
6      Число 1.0     Карта запрещена
7      Число 1.0     Не вести накопление по карте
8      Число 1.0     Применять на позицию
9      Число 1.0     Использовать как платежную
10     Число 1.0     Применять на любые позиции
11     Число 5.0     Код схемы сообщений
12     Число 10.0    Количество чеков продаж
13     Число 5.0     Код схемы накопительных скидок
14     Число 1.0     Тип карты (0 – дисконтная, 1 – бонусная)
15     Число 17.2    Сумма бонуса на карте
16     Число 5.0     Код схемы бонусов
17     Число 2.0     Код группы карт
18     Дата          «День рождения»
     Для загрузки условий дисконтных скидок в зависимости от суммы накопления
строка начинается со знака «No», а формат строки следующий:
  No        Тип                      Назначение
поля
1      Число 5.0     Код скидки
2      Строка 30     Название скидки
3      Строка 30     Текст для чека
4      Число 5.1     Процент скидки
5      Число 1.0     Есть начальная сумма
6      Число 17.2    Начальная сумма
7      Число 1.0     Есть конечная сумма
8      Число 17.2    Конечная сумма
9      Число 1.0     Есть начальное количество чеков
10     Число 10.0    Начальное количество чеков
11     Число 1.0     Есть конечное количество чеков
12     Число 10.0    Конечное количество чеков
13     Число 5.0     Код схемы накопительных скидок
14     Строка 25     Название схемы накопительных скидок

     Для загрузки фиксированных скидок строка начинается со знака «^», а формат
строки следующий:
  No        Тип                    Назначение
поля
1      Число 5.0   Код скидки
2      Строка 25   Название скидки
3      Число 1.0   Тип скидки (1-скидка, 2- надбавка)
4      Число 1.0   Вид скидки (1- процентная, 2-суммовая)
5      Число 15.2  Размер скидки
6      Строка 30   Текст для чека
7      Строка 24   Префикс карты
8      Число 1.0   Флаг применения на чек
9      Число 1.0   Флаг применения на позицию
10     Число 1.0   Флаг применения только по карте
11     Число 19.2  Начальная сумма для карты
12     Число 19.2  Конечная сумма для карты
     Для загрузки платежных карт строка начинается со знака «)», а формат строки
следующий:
  No        Тип                    Назначение
поля
1      Строка 24   Номер карты
2      Строка 50   Название карты
3      Число 17.2  Сумма кредита
4      Число 1.0   Флаг запрета карты
     Для загрузки наборов прав строка начинается со знака «~», а формат строки
следующий:
  No        Тип                    Назначение
поля
1      Число 5.0   Код набора прав
2      Строка 25   Название набора прав
3      Строка 24   Номер карты
4      Число 5.0   Номер ключа
5      Число 1.0   Ключ клавиатуры
6      Число 1.0   Требуется ключ для авторизации
...      Число 1.0   Флаги для каждой операции в той
                   последовательности, как заданы в
                   конфигураторе.
     Для загрузки пользователей строка начинается со знака «&», а формат строки
следующий:
  No        Тип                    Назначение
поля
1      Число 2.0   Код пользователя
2      Строка 17   Имя пользователя
3      Число 5.0   Код набора прав
4      Строка 24   Пароль пользователя

     Для загрузки фиксированных скидок строка начинается со знака «^», а формат
строки следующий:
  No        Тип                    Назначение
поля
1      Число 5.0   Код скидки
2      Строка 25   Название скидки
3      Число 1.0   Тип скидки (1-скидка, 2- надбавка)
4      Число 1.0   Вид скидки (1- процентная, 2-суммовая)
5      Число 15.2  Размер скидки
6      Строка 30   Текст для чека
7      Строка 24   Префикс карты
8      Число 1.0   Флаг применения на чек
9      Число 1.0   Флаг применения на позицию
10     Число 1.0   Флаг применения только по карте
11     Число 19.2  Начальная сумма для карты
12     Число 19.2  Конечная сумма для карты
     Для загрузки платежных карт строка начинается со знака «)», а формат строки
следующий:
  No        Тип                    Назначение
поля
1      Строка 24   Номер карты
2      Строка 50   Название карты
3      Число 17.2  Сумма кредита
4      Число 1.0   Флаг запрета карты
     Для загрузки наборов прав строка начинается со знака «~», а формат строки
следующий:
  No        Тип                    Назначение
поля
1      Число 5.0   Код набора прав
2      Строка 25   Название набора прав
3      Строка 24   Номер карты
4      Число 5.0   Номер ключа
5      Число 1.0   Ключ клавиатуры
6      Число 1.0   Требуется ключ для авторизации
...      Число 1.0   Флаги для каждой операции в той
                   последовательности, как заданы в
                   конфигураторе.
     Для загрузки пользователей строка начинается со знака «&», а формат строки
следующий:
  No        Тип                    Назначение
поля
1      Число 2.0   Код пользователя
2      Строка 17   Имя пользователя
3      Число 5.0   Код набора прав
4      Строка 24   Пароль пользователя

     Для загрузки весовых штрих-кодов строка начинается со знака «(», а формат строки
следующий:
  No       Тип                      Назначение
поля
1     Число 2.0     Префикс штрих-кода
2     Число 1.0     0 – вес+код;
                    1 – код+вес;
                    2 – вес+цена;
                    3 – цена+вес;
                    4 – код+цена;
                    5 – цена+код;
3     Число 1.0     Число знаков под код
4     Число 5.3     Коэффициент веса
5     Число 5.2     Коэффициент цены
6     Число 1.0     Поиск по штрих-коду
7     Число 1.0     Дополнять штрих-код до EAN-13
     Для загрузки справочника налогов строка начинается со знака «+», а формат строки
следующий:
  No       Тип                      Назначение
поля
1     Число 2.0     Код налога
2     Строка 25     Название налога
3     Строка 30     Текст для печати
4     Число 4.1     Процентная ставка налога
5     Число 1.0     Номер налога в ККМ
     Для загрузки налоговых групп строка начинается со знака «*», а формат строки
следующий:
  No       Тип                      Назначение
поля
1     Число 2.0     Код группы налогов
2     Строка 25     Название группы налогов
3     Число 2.0     Номер налога в группе
4     Число 2.0     Код налога
5     Число 2.0     Секция налога
     Для загрузки банковских карт строка начинается со знака «]», а формат строки
следующий:
  No       Тип                      Назначение
поля
1     Число 2.0     Код карты
2     Строка 25     Название карты
3     Число 1.0     Карта требует ПИН

     Для загрузки сообщений по дисконтным картам строка начинается со знака «}», а
формат строки следующий:
  No       Тип                      Назначение
поля
1     Число 2.0     Код сообщения
2     Строка 25     Название сообщения
3     Число 17.2    Сумма срабатывания сообщения
4     Число 10.0    Количество      чеков     срабатывания
                    сообщения
5     Строка 150 Текст для вывода на экран (Разделители
                    строк заменяются символами «|»
6     Строка 150 Текст для печати в чеке (Разделители
                    строк заменяются символами «|»
7     Число 5.0     Код схемы сообщений
8     Строка 50 Название схемы сообщений
     Для загрузки продавцов строка начинается со знака «[», а формат строки
следующий:
  No       Тип                      Назначение
поля
1     Строка 24     Код продавца
2     Строка 50     Название продавца
3     Строка 30     Текст для чека
     Для загрузки «горячих» клавиш строка начинается со знака «’», а формат строки
следующий:
  No       Тип                      Назначение
поля
1     Число 2.0     Код клавиши
2     Строка 50     Название клавиши
3     Строка 20     Текст для печати (разделители строк
                    заменяются символами «|»)
4     Число 2.0     Номер секции
5     Строка 100 Название товара
6     Строка 6      Код клавиши
7     Число 1.0     Флаг комплекта
     Для загрузки товаров на «горячих» клавишах строка начинается со знака «”», а
формат строки следующий:
  No       Тип                      Назначение
поля
1     Число 2.0     Код клавиши
2     Число 13.0    Код товара
3     Строка 50     Название товара на клавише
5     Число 13.0    Код товара для POS NCR
6     Строка 20     Текст для печати (разделители строк
                    заменяются символами «|»)
7     Строка 13     Штрих-код товара

     Для загрузки схем бонусов строка начинается со знака «_», а формат строки
следующий:
  No        Тип                       Назначение
поля
1      Строка 5.0     Код схемы бонусов
2      Строка 25      Название схемы
3      Число 5.1      Процент бонуса
4      Число 17.2     Порог оплаты бонусом
5      Строка 30      Текст для чека
     Также имеется возможность загружать константы-настройки в следующем формате:
     |<ИмяКонстанты>=<Значение>
     где <ИмяКонстанты> - идентификатор константы-настройки, как задан в
кофигураторе (знакозависим), <Значение> = значение данной константы.
     Кроме данных для загрузки файл загрузки может содержать служебные команды для
загрузки. Служебные команды всегда располагаются или в первой или в последней строке
файла загрузки и начинаются с символов «$$$». Допускаются следующие служебные
команды:
     «$$$ADD» - добавление количества товара;
     «$$$RPL» - замещение количества товара;
     «$$$CLR» - очистка справочника товаров перед загрузкой.
     Вместе с командой $$$CLR допустимы следующие команды (должны содержаться в
той же строке, что и $$$CLR):
       {NO_TOV} – очистка справочника товаров не производится
       {AUT_S} – очистка схем автоматических скидок
       {DIS_C} – очистка списка дисконтных карт
       {USR} – очистка справочника пользователей
       {NAB_P} – очистка наборов прав
       {FIX_S} – очистка фиксированных скидок
       {V_SHK} – очистка весовых штрих-кодов
       {PAY_C} – очистка списка платежных карт
       {NAL} – очистка списка налогов
       {GR_NL} – очистка налоговых групп
       {PROD} – очистка списка продавцов
       {B_CRD} – очистка списка банковских кредитных карт
       {MES} – очистка списка сообщений по дисконтным картам
       {VAL} – очистка списка валют
       {HOT_K} – очистка «горячих» клавиш
       {MOB_OP} – очистка справочника операторов связи
       {BON} – очистка схем бонусов


Выгрузка продаж

Файл выгрузки продаж
     Файл отчета о продажах товара состоит из двух частей: шапки файла и
непосредственно информации о продажах.
Шапка файла состоит из двух строк:
 - Первая строка – признак обработки данного файла товароучетной программой «#» (1
    символ). После того, как файл будет обработан АСТУ, символ «#» должен быть
    заменен на «@» для возможности выгружать другие отчеты в файл с тем же именем.
 - Вторая строка содержит логический номер ККМ (см. «Закладка «Основные»» стр. 17).
 - Третья строка содержит порядковый номер отчета.
     После шапки файла следует информация о продажах товара. Отчет о продажах
представлен в виде последовательности транзакций, правила формирования которых
представлены ниже. Одна строка текстового файла содержит информацию об одной
транзакции. Данные в строке разделяются «;» и располагаются в порядке приведенном в
таблице ниже.
                    No           Тип               Назначение
                   поля
                  1       Целое             No транзакции
                  2       Дата              Дата транзакции
                  3       Время             Время транзакции
                  4       Целое             Тип транзакции
                  5       Целое             Номер ККМ
                  6       Целое             Номер чека
                  7       Целое             Код кассир
                  8       Строка 13
                  9       Целое
                  10      Дробное 8.2
                  11      Дробное 7.3
                  12      Дробное 8.2
     Назначение первых семи полей фиксированное, а остальных зависит от типа
транзакции и приводится в таблице ниже.

  Название                                  Назначение полей
              Тип
                          8          9         10          11           12
                                         Регистрация
                                                                      Цена *
Регистрация   1 / 11  - / Код     Секция      Цена     Количество
                                                                    Количество
                                                                      Цена *
                                                                   Количество –
Сторно        2 / 12  - / Код     Секция      Цена    Количество   Сумма скидки
                                                                     + Сумма
                                                                     надбавки
                                                                      Цена *
Возврат       3/ 13   - / Код     Секция      Цена     Количество
                                                                    Количество
Возврат в                                                             Цена *
              4/ 14   - / Код     Секция      Цена     Количество
чеке продажи                                                        Количество
                      Штрих-
Регистрация
                24                Секция        -    Коэффициент         -
                        код
единицы
                     единицы
Редактирован            Код                 Исходная
                30                Секция             Код доп. цены  Новая цена
ие цены               товара                  цена
                     Итоговые скидки/надбавки на позицию
Скидка
                15      Код       Секция        -    Сумма скидки Сумма скидки
суммой
Надбавка                                                 Сумма        Сумма
                16      Код       Секция        -
суммой                                                  надбавки     надбавки
                                                        Процент
Скидка %        17      Код       Секция        -                  Сумма скидки
                                                         скидки
                                                                      Сумма
                                                        Процент
Надбавка %      18      Код       Секция        -
                                                         скидки      надбавки
                            Детализация скидок/надбавок
Детализация
                     Параметр      Вид      Параметр    Процент
                70                                                 Сумма скидки
скидки на
                     скидки 1     скидки    скидки 2     скидки
позицию
Детализация          Параметр      Вид      Параметр    Параметр
                                                                   Сумма скидки
                71
скидки на чек        скидки 1     скидки    скидки 2    скидки 3
                                  Дополнительные
                        Код
                                             Сумма     Номер вида
Оплата          40                   -                             Сумма оплаты
                     платежн.
                                             сдачи       оплаты
                      карты
                                                                      Сумма
Внесение        50        -          -          -           -
                                                                     внесения
                                                                      Сумма
Выплата         51        -          -          -           -
                                                                     выплаты
Закрытие              Штрих-
                55                   -          -           -       Сумма чека
чека                 код чека
Отмена чека     56        -          -          -           -       Сумма чека
Отложенный
                58        -          -          -           -       Сумма чека
чек

 Продолжение
                  59         -          -           -            -         Сумма чека
 отложенного
 чека
 Открыт
                  65         -          -           -            -              -
 денежный
 ящик
 Просмотр                  Код
                  66                    -           -            -              -
 товара                   товара
 Просмотр
                          Номер
                  67                    -           -            -              -
 дисконтной
                          карты
 карты
                                                Сумма     No транзакции       Номер
 Возврат по             Дата чека
                  80                    -         чека    возвращаемого возвращаемого
 номеру чека            продажи
                                               продажи         чека           чека
                            Итоговые скидки/надбавки на чек
 Скидка
                  35         -          -           -     Сумма скидки Сумма скидки
 суммой
 Надбавка                                                     Сумма
                                                                        Сумма надбавки
                  36         -          -           -
 суммой                                                     надбавки
                                                             Процент
 Скидка %         37         -          -           -                    Сумма скидки
                                                             скидки
                                                             Процент
 Надбавка %       38         -          -           -                   Сумма надбавки
                                                            надбавки
                                          Отчеты
                          Номер                Наличнос
 X – отчет       60                     -                       -        Сумма выручки
                          отчета               ть в кассе
                          Номер                Наличнос
 Z – отчет       61                     -                       -        Сумма выручки
                          отчета               ть в кассе
 Расширенн                  Вид
                 62                     -           -           -               -
 ый отчет                 отчета
 Закрытие
                        Код плат.
 дня по
                 63                     -           -           -               -
                         системы
 кредитным
 картам
                                          Налоги
                            Код                 Оборот
 Налог           75                  Секция                     -         Сумма налога
                          налога                налога
                                        Продавцы
 Продавец                   Код
                 90                  Секция         -           -               -
 позиции                продавца
 Продавец                   Код
                 91                     -           -           -               -
 чека                   продавца
Расшифровка параметров:
      Вид скидки: 0 – ручная скидка, 1 – фиксированная скидка, 2 – автоматическая
скидка, 3 – скидка по дисконтной карте, 4 – бонусная карта;
      Параметр скидки 1 = код схемы скидки в случае автоматической скидки, код
дисконтной карты в случае скидки по дисконтной карте;

